üöÄ Running api-keys.sh...
insid pid: 570880
2025-06-21T11:05:15.414-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:05:15.414-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2222 [Follower]" leader-address= leader-id=
2025-06-21T11:05:15.415-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:05:15.415-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2223 [Follower]" leader-address= leader-id=
2025-06-21T11:05:15.417-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:05:15.417-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2224 [Follower]" leader-address= leader-id=
Launching server 127.0.0.1:8443
Launching server 127.0.0.1:8446
2025-06-21T11:05:16.683-0400 [WARN]  no known peers, aborting election
2025-06-21T11:05:16.863-0400 [WARN]  no known peers, aborting election
2025-06-21T11:05:17.357-0400 [WARN]  heartbeat timeout reached, starting election: last-leader-addr= last-leader-id=
2025-06-21T11:05:17.357-0400 [INFO]  entering candidate state: node="Node at 127.0.0.1:2222 [Candidate]" term=2
2025-06-21T11:05:17.357-0400 [INFO]  pre-vote successful, starting election: term=2 tally=1 refused=0 votesNeeded=1
2025-06-21T11:05:17.366-0400 [INFO]  election won: term=2 tally=1
2025-06-21T11:05:17.366-0400 [INFO]  entering leader state: leader="Node at 127.0.0.1:2222 [Leader]"
2025-06-21T11:05:25.428-0400 [INFO]  updating configuration: command=AddVoter server-id=node2 server-addr=127.0.0.1:2224 servers="[{Suffrage:Voter ID:node0 Address:127.0.0.1:2222} {Suffrage:Voter ID:node2 Address:127.0.0.1:2224}]"
set root tracker key internal:api_key_memory_usage: value 0
2025-06-21T11:05:25.430-0400 [INFO]  added peer, starting replication: peer=node2
2025-06-21T11:05:25.433-0400 [INFO]  updating configuration: command=AddVoter server-id=node1 server-addr=127.0.0.1:2223 servers="[{Suffrage:Voter ID:node0 Address:127.0.0.1:2222} {Suffrage:Voter ID:node2 Address:127.0.0.1:2224} {Suffrage:Voter ID:node1 Address:127.0.0.1:2223}]"
2025-06-21T11:05:25.434-0400 [WARN]  failed to get previous log: previous-index=4 last-index=0 error="log not found"
2025-06-21T11:05:25.435-0400 [WARN]  appendEntries rejected, sending older logs: peer="{Voter node2 127.0.0.1:2224}" next=1
Launching server 127.0.0.1:8445
Launching server 127.0.0.1:8448
2025-06-21T11:05:25.438-0400 [INFO]  added peer, starting replication: peer=node1
2025-06-21T11:05:25.439-0400 [INFO]  pipelining replication: peer="{Voter node2 127.0.0.1:2224}"
2025-06-21T11:05:25.441-0400 [WARN]  failed to get previous log: previous-index=6 last-index=0 error="log not found"
2025-06-21T11:05:25.441-0400 [WARN]  appendEntries rejected, sending older logs: peer="{Voter node1 127.0.0.1:2223}" next=1
set root tracker key internal:api_key_disk_usage: value 0
Launching server 127.0.0.1:8444
Launching server 127.0.0.1:8447
2025-06-21T11:05:25.456-0400 [INFO]  pipelining replication: peer="{Voter node1 127.0.0.1:2223}"
set root tracker key internal:api_key_events: value 0
set root tracker key internal:api_key_subscriptions: value 0
set root tracker key internal:api_key_max_memory_usage:
set root tracker key internal:api_key_max_disk_usage:
set root tracker key internal:api_key_max_events:
set root tracker key internal:api_key_max_subscriptions:
‚ÑπÔ∏è Using insic executable: /tmp/insi-test-cluster/insic
‚ÑπÔ∏è Using config: /tmp/insi-test-cluster/cluster.yaml

[0;34m==== Pre-Test: Server Ping Check ====[0m
‚ÑπÔ∏è Attempting to ping server... (will retry up to 15 times)
‚úÖ Server is responsive.
‚úÖ [0;32mSUCCESS: Server Ping (and output contains 'Ping Response:')[0m
‚ÑπÔ∏è Starting TKV API Key operations tests...

[0;34m==== Test: API Key Lifecycle (Add, Verify, Delete) ====[0m
‚ÑπÔ∏è Attempting to add API key: testapikey_1750518330_570996
‚úÖ [0;32mSUCCESS: API add key 'testapikey_1750518330_570996' (and output contains 'API Key:')[0m
‚ÑπÔ∏è Parsed generated key: insi_gTN+FqylPIgwzrUtxEP1l846quijgZDV6gNNRn/x+ATyLrzP5V5TJmiDwn4aK/R9pOpE2GkH481WgcjqtGS3ZuUgaDSDpkaLi2uz3xPNo8t2gxH8laZFeAFH738SPy2w/Y5H50pxALyiMHXCOPziTOETHj0=
‚ÑπÔ∏è Attempting to verify newly created API key: insi_gTN+FqylPIgwzrUtxEP1l846quijgZDV6gNNRn/x+ATyLrzP5V5TJmiDwn4aK/R9pOpE2GkH481WgcjqtGS3ZuUgaDSDpkaLi2uz3xPNo8t2gxH8laZFeAFH738SPy2w/Y5H50pxALyiMHXCOPziTOETHj0=
‚úÖ [0;32mSUCCESS: API verify for new key 'insi_gTN+FqylPIgwzrUtxEP1l846quijgZDV6gNNRn/x+ATyLrzP5V5TJmiDwn4aK/R9pOpE2GkH481WgcjqtGS3ZuUgaDSDpkaLi2uz3xPNo8t2gxH8laZFeAFH738SPy2w/Y5H50pxALyiMHXCOPziTOETHj0=' (and output contains 'API Key Verified Successfully!')[0m
‚ÑπÔ∏è Attempting to delete API key: insi_gTN+FqylPIgwzrUtxEP1l846quijgZDV6gNNRn/x+ATyLrzP5V5TJmiDwn4aK/R9pOpE2GkH481WgcjqtGS3ZuUgaDSDpkaLi2uz3xPNo8t2gxH8laZFeAFH738SPy2w/Y5H50pxALyiMHXCOPziTOETHj0=
‚úÖ [0;32mSUCCESS: API delete for key 'insi_gTN+FqylPIgwzrUtxEP1l846quijgZDV6gNNRn/x+ATyLrzP5V5TJmiDwn4aK/R9pOpE2GkH481WgcjqtGS3ZuUgaDSDpkaLi2uz3xPNo8t2gxH8laZFeAFH738SPy2w/Y5H50pxALyiMHXCOPziTOETHj0=' (and output contains 'OK')[0m
‚ÑπÔ∏è Attempting to verify deleted API key: insi_gTN+FqylPIgwzrUtxEP1l846quijgZDV6gNNRn/x+ATyLrzP5V5TJmiDwn4aK/R9pOpE2GkH481WgcjqtGS3ZuUgaDSDpkaLi2uz3xPNo8t2gxH8laZFeAFH738SPy2w/Y5H50pxALyiMHXCOPziTOETHj0=
‚úÖ [0;32mSUCCESS (Received Expected Error): API verify for deleted key 'insi_gTN+FqylPIgwzrUtxEP1l846quijgZDV6gNNRn/x+ATyLrzP5V5TJmiDwn4aK/R9pOpE2GkH481WgcjqtGS3ZuUgaDSDpkaLi2uz3xPNo8t2gxH8laZFeAFH738SPy2w/Y5H50pxALyiMHXCOPziTOETHj0=' (and output contains 'Verification FAILED')[0m
‚ÑπÔ∏è Attempting to verify random invalid API key: invalidkey_1750518347_570996_random
‚úÖ [0;32mSUCCESS (Received Expected Error): API verify for random key 'invalidkey_1750518347_570996_random' (and output contains 'Verification FAILED')[0m
‚ÑπÔ∏è Attempting to delete random invalid API key: invalidkey_1750518347_570996_random
‚úÖ [0;32mSUCCESS (Received Expected Error): API delete for non-existent key 'invalidkey_1750518347_570996_random' (and output contains 'Error')[0m

[0;34m==== Test: Admin Privileges (requires --root) ====[0m
‚ÑπÔ∏è Attempting to add an API key without --root (should fail)
‚úÖ [0;32mSUCCESS (Received Expected Error): API add without --root (and output contains 'requires --root flag')[0m
‚ÑπÔ∏è Adding a key with --root to test deletion
‚úÖ [0;32mSUCCESS: Created temporary key for delete test: insi_Mtx5LXzS8fLS3bYIWwT7ECwku3sOzwl1xB+jlCr9HrkdrOZC7I/V/vOymQ4EP+WPSESiobeu2YajVwyKsTEIdxSNlLzYurotTQNZdhlVduF/JrAeJo3lzPyemjHjhNZboBrsVnBm9dKmxy8pHfwCaK7TueE=[0m
‚ÑπÔ∏è Attempting to delete an API key without --root (should fail)
‚úÖ [0;32mSUCCESS (Received Expected Error): API delete without --root (and output contains 'requires --root flag')[0m
‚ÑπÔ∏è Cleaning up key with --root
‚úÖ [0;32mSUCCESS: API delete with --root (cleanup) (and output contains 'OK')[0m

[0;34m==== Test: API Key Limits (Get, Set) ====[0m
‚ÑπÔ∏è Attempting to add API key for limits test: testlimitskey_1750518352_570996
‚úÖ [0;32mSUCCESS: API add key 'testlimitskey_1750518352_570996' for limits test (and output contains 'API Key:')[0m
‚ÑπÔ∏è Parsed generated key for limits test: insi_DyOHMrjK+K7EQ/jrM/TlR7VqiAs6dWk3EDNRserFXmE5agZcjgzP9AQIyh3kWpvJBLPip7tIBEniF+63ynRievGmHws1biUbh+7n5S5N0rbylsOa0kArrqo2UH1qshMbA37rdOazsAIRCMAvpG6Mk7nGl68=
‚ÑπÔ∏è Attempting to get initial limits for key: insi_DyOHMrjK+K7EQ/jrM/TlR7VqiAs6dWk3EDNRserFXmE5agZcjgzP9AQIyh3kWpvJBLPip7tIBEniF+63ynRievGmHws1biUbh+7n5S5N0rbylsOa0kArrqo2UH1qshMbA37rdOazsAIRCMAvpG6Mk7nGl68=
‚úÖ [0;32mSUCCESS: Get initial limits for new key (and output contains 'Maximum Limits')[0m
‚úÖ [0;32mSUCCESS: Check initial current usage is zero (and output contains 'Bytes on Disk:     0')[0m
‚ÑπÔ∏è Attempting to set limits for key: insi_DyOHMrjK+K7EQ/jrM/TlR7VqiAs6dWk3EDNRserFXmE5agZcjgzP9AQIyh3kWpvJBLPip7tIBEniF+63ynRievGmHws1biUbh+7n5S5N0rbylsOa0kArrqo2UH1qshMbA37rdOazsAIRCMAvpG6Mk7nGl68=
‚úÖ [0;32mSUCCESS: Set new limits for key 'insi_DyOHMrjK+K7EQ/jrM/TlR7VqiAs6dWk3EDNRserFXmE5agZcjgzP9AQIyh3kWpvJBLPip7tIBEniF+63ynRievGmHws1biUbh+7n5S5N0rbylsOa0kArrqo2UH1qshMbA37rdOazsAIRCMAvpG6Mk7nGl68=' (and output contains 'OK')[0m
‚ÑπÔ∏è Attempting to get updated limits for key: insi_DyOHMrjK+K7EQ/jrM/TlR7VqiAs6dWk3EDNRserFXmE5agZcjgzP9AQIyh3kWpvJBLPip7tIBEniF+63ynRievGmHws1biUbh+7n5S5N0rbylsOa0kArrqo2UH1qshMbA37rdOazsAIRCMAvpG6Mk7nGl68=
‚úÖ [0;32mSUCCESS: Get updated limits for key 'insi_DyOHMrjK+K7EQ/jrM/TlR7VqiAs6dWk3EDNRserFXmE5agZcjgzP9AQIyh3kWpvJBLPip7tIBEniF+63ynRievGmHws1biUbh+7n5S5N0rbylsOa0kArrqo2UH1qshMbA37rdOazsAIRCMAvpG6Mk7nGl68=' (and output contains 'Maximum Limits')[0m
‚úÖ [0;32mSUCCESS: Verify updated disk limit (and output contains 'Bytes on Disk:     123456789')[0m
‚úÖ [0;32mSUCCESS: Verify updated memory limit (and output contains 'Bytes in Memory:   987654321')[0m
‚úÖ [0;32mSUCCESS: Verify updated events limit (and output contains 'Events per Second: 500')[0m
‚úÖ [0;32mSUCCESS: Verify updated subscribers limit (and output contains 'Subscribers:       50')[0m
‚ÑπÔ∏è Attempting to delete API key used for limits test: insi_DyOHMrjK+K7EQ/jrM/TlR7VqiAs6dWk3EDNRserFXmE5agZcjgzP9AQIyh3kWpvJBLPip7tIBEniF+63ynRievGmHws1biUbh+7n5S5N0rbylsOa0kArrqo2UH1qshMbA37rdOazsAIRCMAvpG6Mk7nGl68=
‚úÖ [0;32mSUCCESS: API delete for key 'insi_DyOHMrjK+K7EQ/jrM/TlR7VqiAs6dWk3EDNRserFXmE5agZcjgzP9AQIyh3kWpvJBLPip7tIBEniF+63ynRievGmHws1biUbh+7n5S5N0rbylsOa0kArrqo2UH1qshMbA37rdOazsAIRCMAvpG6Mk7nGl68=' after limits test (and output contains 'OK')[0m

[0;34m==== Test: API Get Another Key's Limits (as root) ====[0m
‚ÑπÔ∏è Attempting to add API key for get-limits test: testgetlimits_1750518362_570996
‚úÖ [0;32mSUCCESS: API add key 'testgetlimits_1750518362_570996' for get-limits test (and output contains 'API Key:')[0m
‚ÑπÔ∏è Parsed generated key for get-limits test: insi_2G7phGqC1kk/90lexkjVcAUDia0cCAfqWregp7FRsdDezIsF/rSCc32bmpRY0sI1umkz5AKzr/8URrcyBbyVJBfF/97Tm5xAfBaZXF2zcrW/0a1zcWbstkn8mYARr+n+7Niwq5GNbfTl/0/PUvnLSd3qROU=
‚ÑπÔ∏è Attempting to set limits for key: insi_2G7phGqC1kk/90lexkjVcAUDia0cCAfqWregp7FRsdDezIsF/rSCc32bmpRY0sI1umkz5AKzr/8URrcyBbyVJBfF/97Tm5xAfBaZXF2zcrW/0a1zcWbstkn8mYARr+n+7Niwq5GNbfTl/0/PUvnLSd3qROU=
‚úÖ [0;32mSUCCESS: Set new limits for key 'insi_2G7phGqC1kk/90lexkjVcAUDia0cCAfqWregp7FRsdDezIsF/rSCc32bmpRY0sI1umkz5AKzr/8URrcyBbyVJBfF/97Tm5xAfBaZXF2zcrW/0a1zcWbstkn8mYARr+n+7Niwq5GNbfTl/0/PUvnLSd3qROU=' (and output contains 'OK')[0m
‚ÑπÔ∏è Attempting to get specific limits for key 'insi_2G7phGqC1kk/90lexkjVcAUDia0cCAfqWregp7FRsdDezIsF/rSCc32bmpRY0sI1umkz5AKzr/8URrcyBbyVJBfF/97Tm5xAfBaZXF2zcrW/0a1zcWbstkn8mYARr+n+7Niwq5GNbfTl/0/PUvnLSd3qROU=' using root
‚úÖ [0;32mSUCCESS: Get specific limits for key 'insi_2G7phGqC1kk/90lexkjVcAUDia0cCAfqWregp7FRsdDezIsF/rSCc32bmpRY0sI1umkz5AKzr/8URrcyBbyVJBfF/97Tm5xAfBaZXF2zcrW/0a1zcWbstkn8mYARr+n+7Niwq5GNbfTl/0/PUvnLSd3qROU=' (and output contains 'Maximum Limits')[0m
‚úÖ [0;32mSUCCESS: Verify specific disk limit (and output contains 'Bytes on Disk:     555666777')[0m
‚úÖ [0;32mSUCCESS: Verify specific memory limit (and output contains 'Bytes in Memory:   111222333')[0m
‚úÖ [0;32mSUCCESS: Verify specific events limit (and output contains 'Events per Second: 250')[0m
‚úÖ [0;32mSUCCESS: Verify specific subscribers limit (and output contains 'Subscribers:       25')[0m
‚ÑπÔ∏è Attempting to get specific limits for key 'insi_2G7phGqC1kk/90lexkjVcAUDia0cCAfqWregp7FRsdDezIsF/rSCc32bmpRY0sI1umkz5AKzr/8URrcyBbyVJBfF/97Tm5xAfBaZXF2zcrW/0a1zcWbstkn8mYARr+n+7Niwq5GNbfTl/0/PUvnLSd3qROU=' WITHOUT root
‚úÖ [0;32mSUCCESS (Received Expected Error): Get specific limits without root (and output contains 'requires --root flag')[0m
‚ÑπÔ∏è Attempting to delete API key used for get-limits test: insi_2G7phGqC1kk/90lexkjVcAUDia0cCAfqWregp7FRsdDezIsF/rSCc32bmpRY0sI1umkz5AKzr/8URrcyBbyVJBfF/97Tm5xAfBaZXF2zcrW/0a1zcWbstkn8mYARr+n+7Niwq5GNbfTl/0/PUvnLSd3qROU=
‚úÖ [0;32mSUCCESS: API delete for key 'insi_2G7phGqC1kk/90lexkjVcAUDia0cCAfqWregp7FRsdDezIsF/rSCc32bmpRY0sI1umkz5AKzr/8URrcyBbyVJBfF/97Tm5xAfBaZXF2zcrW/0a1zcWbstkn8mYARr+n+7Niwq5GNbfTl/0/PUvnLSd3qROU=' after get-limits test (and output contains 'OK')[0m

[0;34m==== Test: API Key Aliases (Add, List, Use, Delete, Data Scope, Chaining) ====[0m
‚ÑπÔ∏è Creating primary key 'primary_for_alias_1750518373_570996' for alias test
‚úÖ [0;32mSUCCESS: Create primary key for alias test (and output contains 'API Key:')[0m
‚ÑπÔ∏è Parsed primary key: insi_8tZaiKeBdX+f1mL+I9JrL4ogpOwY3XiDwToYeLxwiIi2QkltehULtQyHRroQiEE/6JOhu1sNlJQbRvRwhJCuRLNF+bKNq/IRjqC5M5KnQ6OLq6Lb5J8jCwEUKOIx/CdRYnrVhOIYbpQQHpHtjOYogRKcW38=
‚ÑπÔ∏è Setting a value with the primary key 'insi_8tZaiKeBdX+f1mL+I9JrL4ogpOwY3XiDwToYeLxwiIi2QkltehULtQyHRroQiEE/6JOhu1sNlJQbRvRwhJCuRLNF+bKNq/IRjqC5M5KnQ6OLq6Lb5J8jCwEUKOIx/CdRYnrVhOIYbpQQHpHtjOYogRKcW38=' to test data scope inheritance
‚úÖ [0;32mSUCCESS: Set value with primary key (and output contains 'OK')[0m
‚ÑπÔ∏è Creating first alias for key insi_8tZaiKeBdX+f1mL+I9JrL4ogpOwY3XiDwToYeLxwiIi2QkltehULtQyHRroQiEE/6JOhu1sNlJQbRvRwhJCuRLNF+bKNq/IRjqC5M5KnQ6OLq6Lb5J8jCwEUKOIx/CdRYnrVhOIYbpQQHpHtjOYogRKcW38=
‚úÖ [0;32mSUCCESS: Create first alias (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Parsed alias 1 key: insi_DA4889waX/ZCLx6L8QBavFT4Z3ZfCKNcrGc6cyKLT6Y7fF+LGWVnDNvRjIv6Pw32rlQG/RxV8WFPfNiUIpx43lR6IPpeoNKNKrYM2sPWSzM82BuL5BjvhishsVsX2aGimuAKYocg53hYzGiIdQxwLw/A2B9QMUe+q3T48xVhFWWjOr6w
‚ÑπÔ∏è Getting value with the alias key 'insi_DA4889waX/ZCLx6L8QBavFT4Z3ZfCKNcrGc6cyKLT6Y7fF+LGWVnDNvRjIv6Pw32rlQG/RxV8WFPfNiUIpx43lR6IPpeoNKNKrYM2sPWSzM82BuL5BjvhishsVsX2aGimuAKYocg53hYzGiIdQxwLw/A2B9QMUe+q3T48xVhFWWjOr6w' to test data scope
‚úÖ [0;32mSUCCESS: Get value with alias key (and output contains 'alias-test-value')[0m
‚ÑπÔ∏è Attempting to create an alias from another alias (should fail)
‚úÖ [0;32mSUCCESS (Received Expected Error): Create alias from alias key (and output contains 'Cannot create an alias from an alias key')[0m
‚ÑπÔ∏è Setting a value with the alias key 'insi_DA4889waX/ZCLx6L8QBavFT4Z3ZfCKNcrGc6cyKLT6Y7fF+LGWVnDNvRjIv6Pw32rlQG/RxV8WFPfNiUIpx43lR6IPpeoNKNKrYM2sPWSzM82BuL5BjvhishsVsX2aGimuAKYocg53hYzGiIdQxwLw/A2B9QMUe+q3T48xVhFWWjOr6w' to test limit inheritance
‚úÖ [0;32mSUCCESS: Set value with alias key (and output contains 'OK')[0m
‚ÑπÔ∏è Getting value set by alias using the primary key 'insi_8tZaiKeBdX+f1mL+I9JrL4ogpOwY3XiDwToYeLxwiIi2QkltehULtQyHRroQiEE/6JOhu1sNlJQbRvRwhJCuRLNF+bKNq/IRjqC5M5KnQ6OLq6Lb5J8jCwEUKOIx/CdRYnrVhOIYbpQQHpHtjOYogRKcW38='
‚úÖ [0;32mSUCCESS: Get value (set by alias) with primary key (and output contains 'this-should-work')[0m
‚ÑπÔ∏è Creating second alias for key insi_8tZaiKeBdX+f1mL+I9JrL4ogpOwY3XiDwToYeLxwiIi2QkltehULtQyHRroQiEE/6JOhu1sNlJQbRvRwhJCuRLNF+bKNq/IRjqC5M5KnQ6OLq6Lb5J8jCwEUKOIx/CdRYnrVhOIYbpQQHpHtjOYogRKcW38=
‚úÖ [0;32mSUCCESS: Create second alias (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Parsed alias 2 key: insi_3eg6LL26JMujUpfZvl7SIKcUSSlErvgLjRH1pplPsgdR4v1mWflsNSKSE2RNdFfz5rAYJp/NG9i2XRMPhFqkeXYa+n27JWIxeU5ZRQIy1qy3HOv6krgfzP1mrCmX63GrVNcknAL1wh/TYH14igaLdAuFJndJ2hz/vCAAoE0tm1KX2jE1
‚ÑπÔ∏è Listing aliases for primary key insi_8tZaiKeBdX+f1mL+I9JrL4ogpOwY3XiDwToYeLxwiIi2QkltehULtQyHRroQiEE/6JOhu1sNlJQbRvRwhJCuRLNF+bKNq/IRjqC5M5KnQ6OLq6Lb5J8jCwEUKOIx/CdRYnrVhOIYbpQQHpHtjOYogRKcW38=
‚úÖ [0;32mSUCCESS: List aliases (and output contains 'insi_DA4889waX/ZCLx6L8QBavFT4Z3ZfCKNcrGc6cyKLT6Y7fF+LGWVnDNvRjIv6Pw32rlQG/RxV8WFPfNiUIpx43lR6IPpeoNKNKrYM2sPWSzM82BuL5BjvhishsVsX2aGimuAKYocg53hYzGiIdQxwLw/A2B9QMUe+q3T48xVhFWWjOr6w')[0m
‚úÖ [0;32mSUCCESS: Check for second alias in list (and output contains 'insi_3eg6LL26JMujUpfZvl7SIKcUSSlErvgLjRH1pplPsgdR4v1mWflsNSKSE2RNdFfz5rAYJp/NG9i2XRMPhFqkeXYa+n27JWIxeU5ZRQIy1qy3HOv6krgfzP1mrCmX63GrVNcknAL1wh/TYH14igaLdAuFJndJ2hz/vCAAoE0tm1KX2jE1')[0m
‚ÑπÔ∏è Verifying first alias key via ping: insi_DA4889waX/ZCLx6L8QBavFT4Z3ZfCKNcrGc6cyKLT6Y7fF+LGWVnDNvRjIv6Pw32rlQG/RxV8WFPfNiUIpx43lR6IPpeoNKNKrYM2sPWSzM82BuL5BjvhishsVsX2aGimuAKYocg53hYzGiIdQxwLw/A2B9QMUe+q3T48xVhFWWjOr6w
‚úÖ [0;32mSUCCESS: Ping with first alias (and output contains 'Ping Response:')[0m
‚ÑπÔ∏è Verifying second alias key via ping: insi_3eg6LL26JMujUpfZvl7SIKcUSSlErvgLjRH1pplPsgdR4v1mWflsNSKSE2RNdFfz5rAYJp/NG9i2XRMPhFqkeXYa+n27JWIxeU5ZRQIy1qy3HOv6krgfzP1mrCmX63GrVNcknAL1wh/TYH14igaLdAuFJndJ2hz/vCAAoE0tm1KX2jE1
‚úÖ [0;32mSUCCESS: Ping with second alias (and output contains 'Ping Response:')[0m
‚ÑπÔ∏è Deleting first alias key: insi_DA4889waX/ZCLx6L8QBavFT4Z3ZfCKNcrGc6cyKLT6Y7fF+LGWVnDNvRjIv6Pw32rlQG/RxV8WFPfNiUIpx43lR6IPpeoNKNKrYM2sPWSzM82BuL5BjvhishsVsX2aGimuAKYocg53hYzGiIdQxwLw/A2B9QMUe+q3T48xVhFWWjOr6w
‚úÖ [0;32mSUCCESS: Delete first alias (and output contains 'OK')[0m
‚ÑπÔ∏è Verifying that deleted alias is invalid: insi_DA4889waX/ZCLx6L8QBavFT4Z3ZfCKNcrGc6cyKLT6Y7fF+LGWVnDNvRjIv6Pw32rlQG/RxV8WFPfNiUIpx43lR6IPpeoNKNKrYM2sPWSzM82BuL5BjvhishsVsX2aGimuAKYocg53hYzGiIdQxwLw/A2B9QMUe+q3T48xVhFWWjOr6w
‚úÖ [0;32mSUCCESS (Received Expected Error): Verify deleted alias (and output contains 'Verification FAILED')[0m
‚ÑπÔ∏è Verifying the second alias is the only one remaining in the list
‚úÖ [0;32mSUCCESS: List aliases after delete (and output contains 'insi_3eg6LL26JMujUpfZvl7SIKcUSSlErvgLjRH1pplPsgdR4v1mWflsNSKSE2RNdFfz5rAYJp/NG9i2XRMPhFqkeXYa+n27JWIxeU5ZRQIy1qy3HOv6krgfzP1mrCmX63GrVNcknAL1wh/TYH14igaLdAuFJndJ2hz/vCAAoE0tm1KX2jE1')[0m
‚úÖ [0;32mSUCCESS: Deleted alias 'insi_DA4889waX/ZCLx6L8QBavFT4Z3ZfCKNcrGc6cyKLT6Y7fF+LGWVnDNvRjIv6Pw32rlQG/RxV8WFPfNiUIpx43lR6IPpeoNKNKrYM2sPWSzM82BuL5BjvhishsVsX2aGimuAKYocg53hYzGiIdQxwLw/A2B9QMUe+q3T48xVhFWWjOr6w' was not found in list after deletion.[0m
‚ÑπÔ∏è Verifying second alias still works after deleting first: insi_3eg6LL26JMujUpfZvl7SIKcUSSlErvgLjRH1pplPsgdR4v1mWflsNSKSE2RNdFfz5rAYJp/NG9i2XRMPhFqkeXYa+n27JWIxeU5ZRQIy1qy3HOv6krgfzP1mrCmX63GrVNcknAL1wh/TYH14igaLdAuFJndJ2hz/vCAAoE0tm1KX2jE1
‚úÖ [0;32mSUCCESS: Ping with second alias after deleting first (and output contains 'Ping Response:')[0m
‚ÑπÔ∏è Cleanup: Deleting primary key insi_8tZaiKeBdX+f1mL+I9JrL4ogpOwY3XiDwToYeLxwiIi2QkltehULtQyHRroQiEE/6JOhu1sNlJQbRvRwhJCuRLNF+bKNq/IRjqC5M5KnQ6OLq6Lb5J8jCwEUKOIx/CdRYnrVhOIYbpQQHpHtjOYogRKcW38=
‚úÖ [0;32mSUCCESS: Delete primary key for cleanup (and output contains 'OK')[0m

[0;34m==== Test: API Key Alias Limit (Max 16) ====[0m
‚ÑπÔ∏è Creating primary key 'primary_for_alias_limit_1750518395_570996' for alias limit test
‚úÖ [0;32mSUCCESS: Create primary key for alias limit test (and output contains 'API Key:')[0m
‚ÑπÔ∏è Creating 16 aliases (should succeed)
‚ÑπÔ∏è Creating alias #1...
‚úÖ [0;32mSUCCESS: Create alias #1 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Creating alias #2...
‚úÖ [0;32mSUCCESS: Create alias #2 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Creating alias #3...
‚úÖ [0;32mSUCCESS: Create alias #3 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Creating alias #4...
‚úÖ [0;32mSUCCESS: Create alias #4 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Creating alias #5...
‚úÖ [0;32mSUCCESS: Create alias #5 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Creating alias #6...
‚úÖ [0;32mSUCCESS: Create alias #6 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Creating alias #7...
‚úÖ [0;32mSUCCESS: Create alias #7 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Creating alias #8...
‚úÖ [0;32mSUCCESS: Create alias #8 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Creating alias #9...
‚úÖ [0;32mSUCCESS: Create alias #9 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Creating alias #10...
‚úÖ [0;32mSUCCESS: Create alias #10 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Creating alias #11...
‚úÖ [0;32mSUCCESS: Create alias #11 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Creating alias #12...
‚úÖ [0;32mSUCCESS: Create alias #12 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Creating alias #13...
‚úÖ [0;32mSUCCESS: Create alias #13 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Creating alias #14...
‚úÖ [0;32mSUCCESS: Create alias #14 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Creating alias #15...
‚úÖ [0;32mSUCCESS: Create alias #15 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Creating alias #16...
‚úÖ [0;32mSUCCESS: Create alias #16 (and output contains 'Alias Key:')[0m
‚ÑπÔ∏è Attempting to create 17th alias (should fail)
‚úÖ [0;32mSUCCESS (Received Expected Error): Create 17th alias (and output contains 'Alias limit of 16 reached')[0m
‚ÑπÔ∏è Cleanup: Deleting primary key for alias limit test: insi_3sQibU94F89jCQHqKQMaSoTFiME1oOQHznhpA+DSyaCeRFCUmu92/Z2X86k3y2IzFNSLQr1Tz4Qw9tCRSG26D0HQ+JGB1ZqAzHQvSrEhWNaUAZFUYEQk/7TqeiZzDol4a1+pYhl5aS4uApS1acqmFnbm43Y=
‚úÖ [0;32mSUCCESS: Delete primary key for alias limit cleanup (and output contains 'OK')[0m

[0;34m==== Test: Alias Deletion Security ====[0m
‚ÑπÔ∏è Creating primary key A
‚ÑπÔ∏è Creating primary key B
‚ÑπÔ∏è Creating alias A1 for key A
‚ÑπÔ∏è Attempting to delete alias A1 using its own key (should fail)
‚úÖ [0;32mSUCCESS (Received Expected Error): Delete alias with its own key (and output contains 'an alias key cannot be used to delete an alias')[0m
‚ÑπÔ∏è Attempting to delete alias A1 using unrelated key B (should fail)
‚úÖ [0;32mSUCCESS (Received Expected Error): Delete alias with unrelated key (and output contains 'you can only delete aliases belonging to the authenticated key')[0m
‚ÑπÔ∏è Attempting to delete non-existent alias 'alias_nonexistent_1750518406_570996' with key A (should fail)
‚úÖ [0;32mSUCCESS (Received Expected Error): Delete non-existent alias (and output contains 'not found')[0m
‚ÑπÔ∏è Cleanup for alias security test

[0;34m==== Test: Root Key Cannot Create Alias ====[0m
‚ÑπÔ∏è Attempting to create an alias using the system root key (should fail)
‚úÖ [0;32mSUCCESS (Received Expected Error): Create alias with root key (and output contains 'Cannot set alias for root key')[0m

[0;34m==== Test: Alias Shares Parent's Resource Limits ====[0m
‚ÑπÔ∏è Creating primary key 'primary_for_limit_share_1750518407_570996' for limit sharing test
‚ÑπÔ∏è Setting disk limit for 'insi_MPynqRGsA3PhQsKWn2CnIo5P/jtm3QEhDh+rypvUoMFqU9yp8acoNg64l8zJAdqdoHS1g8ETKP9MMZw84vyHnD1kBBcdZPjWzc0P6ua/TZDp2w9/Zq97mgmVMwQTHZ/qqE4D+JEyUJ5CR6f+4sXB533WRko=' to 50 bytes
‚ÑπÔ∏è Creating alias for the limit-restricted key
‚ÑπÔ∏è Created test file '/tmp/insi_limit_test_blob.txt' of size 66 bytes
‚ÑπÔ∏è Attempting to upload blob with alias key (should fail due to limit)
‚úÖ [0;32mSUCCESS (Received Expected Error): Blob upload with alias exceeds disk limit (and output contains 'exceeded')[0m
‚ÑπÔ∏è Attempting to upload blob with primary key (should also fail)
‚úÖ [0;32mSUCCESS (Received Expected Error): Blob upload with primary key exceeds disk limit (and output contains 'exceeded')[0m
‚ÑπÔ∏è Cleanup for shared limits test

[0;34m==== Test: Multi-Alias Data Scope ====[0m
‚ÑπÔ∏è Creating primary key 'primary_for_multi_alias_1750518412_570996' for multi-alias test
‚úÖ [0;32mSUCCESS: Create primary key for multi-alias test (and output contains 'API Key:')[0m
‚ÑπÔ∏è Creating 3 aliases for key insi_E4AEbpmOyeuTYJyM8rZCQW0xDWnYVi9JzkFKUi5g62dtbTzHSNGT4ydYMphzvicBGc2Ib2sHs34VYwOFfq0xhRYqrFrKsDzLROr7083BNqCPAfJAaKCTmo9k56Rvya+Fl8q2P4bHS6LL/llBO4ABYtrhuPM=
‚ÑπÔ∏è  - Alias 1: insi_f7aR+aIEBBGKrbWi0zWtij5eehDPfioNigMHX0SvmuZi+ng0BVt+cSnqEB5BTG0ZRasfPmdFrFCaaqaWdV2QbbKRqNNlGEV5iQOAbn9NtSqTpyLvQyKwMgpnm/+5IhTQUA9kDyvCG7LtwVPPXAj6nodMfYn/ZT85K6++E2GELPu5F512
‚ÑπÔ∏è  - Alias 2: insi_TyXVqQpJNjlGvXJNkZ10pmaba9IaTvCOSwttXgLUkhtiucmJ/brgcHNdvVpIHcgUCLmYtqDAIeLK+mpk5z/rRPFMXILn2SpEaoJPD3CacJot9Zbujw2TmWGgfYLunEOEx8chrQJQFhr+S5QcoyngxMeKyS/wbSlkA0ORRAQj7gH/saFP
‚ÑπÔ∏è  - Alias 3: insi_iTFb4+sQyE0ljOF+v2TH0KraUJJyMEG9sSAPLCoAsuegGsLy+b0gpya//9+Rtx1Unc+n8ENPSAoeAtlyGu7FILW/gM6J+1D148iAHfk2qeZHkMRQwX399+Kj0e3Qgp4GMVjFnI9YYHl/KmhY/E65nZ9kR53zEEFY7yeUKvPRPLBsl+NS
‚ÑπÔ∏è Using Alias 1 to set 'multi_alias_key' to 'value_from_alias1'
‚úÖ [0;32mSUCCESS: Set value with alias 1 (and output contains 'OK')[0m
‚ÑπÔ∏è Using Alias 2 to get 'multi_alias_key'
‚úÖ [0;32mSUCCESS: Get value with alias 2 (and output contains 'value_from_alias1')[0m
‚ÑπÔ∏è Using Alias 3 to update 'multi_alias_key' to 'updated_by_alias3'
‚úÖ [0;32mSUCCESS: Update value with alias 3 (and output contains 'OK')[0m
‚ÑπÔ∏è Using primary key to confirm final value of 'multi_alias_key'
‚úÖ [0;32mSUCCESS: Confirm updated value with primary key (and output contains 'updated_by_alias3')[0m
‚ÑπÔ∏è Cleanup: Deleting primary key for multi-alias test: insi_E4AEbpmOyeuTYJyM8rZCQW0xDWnYVi9JzkFKUi5g62dtbTzHSNGT4ydYMphzvicBGc2Ib2sHs34VYwOFfq0xhRYqrFrKsDzLROr7083BNqCPAfJAaKCTmo9k56Rvya+Fl8q2P4bHS6LL/llBO4ABYtrhuPM=
‚úÖ [0;32mSUCCESS: Delete primary key for multi-alias cleanup (and output contains 'OK')[0m

[0;34m==== Test: Alias Cleanup on Parent Key Deletion ====[0m
‚ÑπÔ∏è Creating primary key 'primary_for_cleanup_test_1750518417_570996' for cleanup test
‚úÖ [0;32mSUCCESS: Create primary key for cleanup test (and output contains 'API Key:')[0m
‚ÑπÔ∏è Parsed primary key for cleanup test: insi_T7y+mLb4y1jG6j/BzYvHumEPNAfysgL/em1KLbXFrtI1r+XZ67nB6/c4Wke22gmxDs5ouFDJ17Z+AKW6n5UMFOYNzVUsyNuw0ocMuvriky0VvBOUySIoax9KeXOEBuMFBeNLBgbNVb649XLtf43Fo2k4eQU=
‚ÑπÔ∏è Creating 3 aliases for key insi_T7y+mLb4y1jG6j/BzYvHumEPNAfysgL/em1KLbXFrtI1r+XZ67nB6/c4Wke22gmxDs5ouFDJ17Z+AKW6n5UMFOYNzVUsyNuw0ocMuvriky0VvBOUySIoax9KeXOEBuMFBeNLBgbNVb649XLtf43Fo2k4eQU=
‚ÑπÔ∏è  - Alias 1: insi_GNKh5/b7yp0t+TJlBgkMMbSAAfqOq1q79m7JAX/w1JVtKeZjrH106DoQ4vFd4sRROj8O6H1GnJo9BbXFlss2u0e1P7N9PnsTHe17uIKQlzxoc2YaHOu8sDtLA1wqTB7pnvTM9oWYDP0CwJh3gdA9iaCcyZIpdXO9FEF6dBNy9LJNDbqJ
‚ÑπÔ∏è  - Alias 2: insi_aAth18bahB6pIwVPU9SuazL6dgGTaVL8xnXiZuRH0BO00bziRrEo1G4KTESRzRVxfX+T8aHg5y+gRpEzuriwUfoGVIaC6RMg9lFNrN4nLZULu7Jaf7W8ciMdLeGA77qhUcpleFVfkase+TmePBFc0VFgth7jASdDb58uIXaQh1qurIne
‚ÑπÔ∏è  - Alias 3: insi_+bWbxamD8YzdJVphH2rs5X/cHxghUAlEOpvnKawli6rsJiey3Q2lBCv24NwaiIs14U5bt8ITw6rLtIyGuFM8nVPMZoNdPXGDpY9UQFjnwQgFspFOC2KhzObUipmUETilKbwVpWdBvtOhjH+d4aBdo+UwEedav5ZQzNTEWQhpMYwcRQyK
‚ÑπÔ∏è Deleting primary key 'insi_T7y+mLb4y1jG6j/BzYvHumEPNAfysgL/em1KLbXFrtI1r+XZ67nB6/c4Wke22gmxDs5ouFDJ17Z+AKW6n5UMFOYNzVUsyNuw0ocMuvriky0VvBOUySIoax9KeXOEBuMFBeNLBgbNVb649XLtf43Fo2k4eQU=' to trigger alias cleanup
‚úÖ [0;32mSUCCESS: Delete primary key to trigger cleanup (and output contains 'OK')[0m
‚ÑπÔ∏è Waiting 45 seconds for tombstone runner to clean up aliases...
‚ÑπÔ∏è Verifying all aliases are now invalid
‚úÖ [0;32mSUCCESS (Received Expected Error): Verify alias 1 is invalid after parent deletion (and output contains 'Verification FAILED')[0m
‚úÖ [0;32mSUCCESS (Received Expected Error): Verify alias 2 is invalid after parent deletion (and output contains 'Verification FAILED')[0m
‚úÖ [0;32mSUCCESS (Received Expected Error): Verify alias 3 is invalid after parent deletion (and output contains 'Verification FAILED')[0m

[0;34m==== Test: Blob file is deleted when parent API key is deleted ====[0m
‚ÑπÔ∏è Creating a primary key for the blob cleanup test
‚úÖ [0;32mCreated key: insi_luwH1NNPM+PsaBYyNX8a934YA3wA0xmWYrmCMcdvV3ppWT28X2D8YJbyAMTgwCjHP+ztJvkg5DQndWb2KJZXCz0NX/bdkUCTZ++NQ58oAcxDoa4H1vGmomNPaK3owTFW21tOpWyjWc0VL8FdnbZGi+vG6Xc=[0m
‚ÑπÔ∏è Uploading blob with the new key
‚úÖ [0;32mSUCCESS: Blob upload with temporary key[0m
‚ÑπÔ∏è Verifying physical blob existence...
‚úÖ [0;32mVerified blob file exists on all 3 nodes before key deletion.[0m
‚ÑπÔ∏è Deleting parent API key 'insi_luwH1NNPM+PsaBYyNX8a934YA3wA0xmWYrmCMcdvV3ppWT28X2D8YJbyAMTgwCjHP+ztJvkg5DQndWb2KJZXCz0NX/bdkUCTZ++NQ58oAcxDoa4H1vGmomNPaK3owTFW21tOpWyjWc0VL8FdnbZGi+vG6Xc='
‚úÖ [0;32mSUCCESS: Delete parent API key (and output contains 'OK')[0m
‚ÑπÔ∏è Waiting 45 seconds for tombstone runner to clean up blobs...
‚ÑπÔ∏è Verifying physical blob no longer exists...
‚úÖ [0;32mVerified blob file was physically deleted from all nodes after parent key deletion.[0m

[0;32mAll TKV API Key operations tests completed.[0m

[0;34m==== Test Summary ====[0m
‚úÖ Successful tests: 88
[0;32mAll API Key tests passed successfully![0m
‚úÖ Success: api-keys.sh completed.
üöÄ Running crud-iter.sh...
insid pid: 572609
2025-06-21T11:08:43.634-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:08:43.635-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2224 [Follower]" leader-address= leader-id=
2025-06-21T11:08:43.635-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:08:43.635-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2222 [Follower]" leader-address= leader-id=
Launching server 127.0.0.1:8443
Launching server 127.0.0.1:8446
2025-06-21T11:08:43.681-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:08:43.681-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2223 [Follower]" leader-address= leader-id=
2025-06-21T11:08:44.739-0400 [WARN]  no known peers, aborting election
2025-06-21T11:08:45.151-0400 [WARN]  heartbeat timeout reached, starting election: last-leader-addr= last-leader-id=
2025-06-21T11:08:45.152-0400 [INFO]  entering candidate state: node="Node at 127.0.0.1:2222 [Candidate]" term=2
2025-06-21T11:08:45.152-0400 [INFO]  pre-vote successful, starting election: term=2 tally=1 refused=0 votesNeeded=1
2025-06-21T11:08:45.159-0400 [INFO]  election won: term=2 tally=1
2025-06-21T11:08:45.159-0400 [INFO]  entering leader state: leader="Node at 127.0.0.1:2222 [Leader]"
2025-06-21T11:08:45.442-0400 [WARN]  no known peers, aborting election
2025-06-21T11:08:53.641-0400 [INFO]  updating configuration: command=AddVoter server-id=node2 server-addr=127.0.0.1:2224 servers="[{Suffrage:Voter ID:node0 Address:127.0.0.1:2222} {Suffrage:Voter ID:node2 Address:127.0.0.1:2224}]"
2025-06-21T11:08:53.646-0400 [INFO]  added peer, starting replication: peer=node2
Launching server 127.0.0.1:8445
Launching server 127.0.0.1:8448
2025-06-21T11:08:53.650-0400 [WARN]  failed to get previous log: previous-index=3 last-index=0 error="log not found"
2025-06-21T11:08:53.650-0400 [WARN]  appendEntries rejected, sending older logs: peer="{Voter node2 127.0.0.1:2224}" next=1
2025-06-21T11:08:53.653-0400 [INFO]  pipelining replication: peer="{Voter node2 127.0.0.1:2224}"
set root tracker key internal:api_key_memory_usage: value 0
set root tracker key internal:api_key_disk_usage: value 0
set root tracker key internal:api_key_events: value 0
2025-06-21T11:08:53.688-0400 [INFO]  updating configuration: command=AddVoter server-id=node1 server-addr=127.0.0.1:2223 servers="[{Suffrage:Voter ID:node0 Address:127.0.0.1:2222} {Suffrage:Voter ID:node2 Address:127.0.0.1:2224} {Suffrage:Voter ID:node1 Address:127.0.0.1:2223}]"
2025-06-21T11:08:53.692-0400 [INFO]  added peer, starting replication: peer=node1
set root tracker key internal:api_key_subscriptions: value 0
set root tracker key internal:api_key_max_memory_usage:
2025-06-21T11:08:53.696-0400 [WARN]  failed to get previous log: previous-index=8 last-index=0 error="log not found"
2025-06-21T11:08:53.696-0400 [WARN]  appendEntries rejected, sending older logs: peer="{Voter node1 127.0.0.1:2223}" next=1
Launching server 127.0.0.1:8444
Launching server 127.0.0.1:8447
2025-06-21T11:08:53.702-0400 [INFO]  pipelining replication: peer="{Voter node1 127.0.0.1:2223}"
set root tracker key internal:api_key_max_disk_usage:
set root tracker key internal:api_key_max_events:
set root tracker key internal:api_key_max_subscriptions:
‚ÑπÔ∏è Using config: /tmp/insi-test-cluster/cluster.yaml

[0;34m==== Pre-Test: Server Ping Check ====[0m
‚úÖ [0;32mServer is online. Proceeding with tests.[0m
‚ÑπÔ∏è Starting TKV data tests with insic: /tmp/insi-test-cluster/insic
‚ÑπÔ∏è Using config: /tmp/insi-test-cluster/cluster.yaml

[0;34m==== Test: Set and Get ====[0m
‚úÖ [0;32mSUCCESS: Set key 'testkey_sg_1750518538' to 'testvalue_sg_1750518538'[0m
   Output: OK
‚úÖ [0;32mSUCCESS: Get key 'testkey_sg_1750518538'[0m
   Output: testvalue_sg_1750518538
‚úÖ [0;32mValue for 'testkey_sg_1750518538' matches![0m

[0;34m==== Test: Get Non-Existent Key ====[0m
‚úÖ [0;32mSUCCESS (Received Expected Error): Get non-existent key 'nonexistentkey_1750518538'[0m
   Output contains: Error: Key 'nonexistentkey_1750518538' not found.
‚úÖ [0;32mCorrectly received an error message for non-existent key.[0m

[0;34m==== Test: Set, Delete, and Get ====[0m
‚úÖ [0;32mSUCCESS: Set key 'testkey_del_1750518538' for deletion test[0m
   Output: OK
‚úÖ [0;32mSUCCESS: Delete key 'testkey_del_1750518538'[0m
   Output: OK
‚úÖ [0;32mSUCCESS (Received Expected Error): Get deleted key 'testkey_del_1750518538'[0m
   Output contains: Error: Key 'testkey_del_1750518538' not found.

[0;34m==== Test: Iterate by Prefix ====[0m
‚úÖ [0;32mSUCCESS: Set key 'iter_prefix_1750518538_key1' for iteration[0m
‚úÖ [0;32mSUCCESS: Set key 'iter_prefix_1750518538_key2' for iteration[0m
‚úÖ [0;32mSUCCESS: Set key 'iter_prefix_1750518538_key3' for iteration[0m
‚úÖ [0;32mSUCCESS: Iterate by prefix 'iter_prefix_1750518538_' (expecting keys)[0m
   Output: iter_prefix_1750518538_key1
iter_prefix_1750518538_key2
iter_prefix_1750518538_key3
‚úÖ [0;32mIterate by prefix 'iter_prefix_1750518538_' successfully retrieved all expected keys and no extras.[0m

[0;34m==== Test: Bump Integer Value ====[0m
‚úÖ [0;32mSUCCESS: Set initial value for bump test ('testkey_bump_1750518539' -> '10')[0m
‚úÖ [0;32mSUCCESS: Bump key 'testkey_bump_1750518539' up by '5'[0m
‚úÖ [0;32mSUCCESS: Get key 'testkey_bump_1750518539' after bumping up[0m
‚úÖ [0;32mValue for 'testkey_bump_1750518539' is '15' as expected.[0m
‚úÖ [0;32mSUCCESS: Bump key 'testkey_bump_1750518539' down by '-10'[0m
‚úÖ [0;32mSUCCESS: Get key 'testkey_bump_1750518539' after bumping down[0m
‚úÖ [0;32mValue for 'testkey_bump_1750518539' is '5' as expected.[0m
‚ÑπÔ∏è Testing bumping below zero (expected to result in '0')...
‚úÖ [0;32mSUCCESS: Bump key 'testkey_bump_1750518539' by '-10' which would go below zero[0m
‚úÖ [0;32mSUCCESS: Get key 'testkey_bump_1750518539' after bumping below zero[0m
‚úÖ [0;32mValue for 'testkey_bump_1750518539' is '0' as expected. Bumping does not go below zero.[0m
‚úÖ [0;32mSUCCESS: Bump non-existent key 'new_bump_key_1750518539' by '100'[0m
‚úÖ [0;32mSUCCESS: Get key 'new_bump_key_1750518539' after initial bump[0m
‚úÖ [0;32mValue for new key 'new_bump_key_1750518539' is '100' as expected.[0m
‚úÖ [0;32mSUCCESS (Received Expected Error): Bump key 'new_bump_key_1750518539' with non-integer value 'not-a-number'[0m
   Output contains: time=2025-06-21T11:08:59.406-04:00 level=ERROR msg="bump: value must be an integer" error="strconv.Atoi: parsing \"not-a-number\": invalid syntax"
Error: Value must be an integer: strconv.Atoi: parsing "not-a-number": invalid syntax
‚úÖ [0;32mSUCCESS (Received Expected Error): Bump key 'non_int_key_1750518539' which holds a string value[0m
   Output contains: time=2025-06-21T11:08:59.466-04:00 level=ERROR msg="Bump failed" key=non_int_key_1750518539 error="server returned status 400 Bad Request: The existing value is not a valid integer, cannot bump.
"
Error: server returned status 400 Bad Request: The existing value is not a valid integer, cannot bump.

[0;32mAll TKV data tests completed.[0m

[0;34m==== Test Summary ====[0m
‚úÖ Successful tests: 21
[0;32mAll tests passed successfully![0m
‚úÖ Success: crud-iter.sh completed.
üöÄ Running cas-setnx.sh...
insid pid: 572934
2025-06-21T11:08:59.840-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:08:59.840-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2224 [Follower]" leader-address= leader-id=
2025-06-21T11:08:59.842-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:08:59.842-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2223 [Follower]" leader-address= leader-id=
2025-06-21T11:08:59.843-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:08:59.843-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2222 [Follower]" leader-address= leader-id=
Launching server 127.0.0.1:8443
Launching server 127.0.0.1:8446
2025-06-21T11:09:01.075-0400 [WARN]  heartbeat timeout reached, starting election: last-leader-addr= last-leader-id=
2025-06-21T11:09:01.075-0400 [INFO]  entering candidate state: node="Node at 127.0.0.1:2222 [Candidate]" term=2
2025-06-21T11:09:01.075-0400 [INFO]  pre-vote successful, starting election: term=2 tally=1 refused=0 votesNeeded=1
2025-06-21T11:09:01.084-0400 [INFO]  election won: term=2 tally=1
2025-06-21T11:09:01.084-0400 [INFO]  entering leader state: leader="Node at 127.0.0.1:2222 [Leader]"
2025-06-21T11:09:01.200-0400 [WARN]  no known peers, aborting election
2025-06-21T11:09:01.779-0400 [WARN]  no known peers, aborting election
2025-06-21T11:09:09.847-0400 [INFO]  updating configuration: command=AddVoter server-id=node1 server-addr=127.0.0.1:2223 servers="[{Suffrage:Voter ID:node0 Address:127.0.0.1:2222} {Suffrage:Voter ID:node1 Address:127.0.0.1:2223}]"
2025-06-21T11:09:09.853-0400 [INFO]  added peer, starting replication: peer=node1
2025-06-21T11:09:09.853-0400 [INFO]  updating configuration: command=AddVoter server-id=node2 server-addr=127.0.0.1:2224 servers="[{Suffrage:Voter ID:node0 Address:127.0.0.1:2222} {Suffrage:Voter ID:node1 Address:127.0.0.1:2223} {Suffrage:Voter ID:node2 Address:127.0.0.1:2224}]"
Launching server 127.0.0.1:8444
Launching server 127.0.0.1:8447
2025-06-21T11:09:09.857-0400 [INFO]  added peer, starting replication: peer=node2
2025-06-21T11:09:09.859-0400 [WARN]  failed to get previous log: previous-index=3 last-index=0 error="log not found"
2025-06-21T11:09:09.859-0400 [WARN]  appendEntries rejected, sending older logs: peer="{Voter node1 127.0.0.1:2223}" next=1
2025-06-21T11:09:09.863-0400 [INFO]  pipelining replication: peer="{Voter node1 127.0.0.1:2223}"
2025-06-21T11:09:09.866-0400 [WARN]  failed to get previous log: previous-index=4 last-index=0 error="log not found"
2025-06-21T11:09:09.866-0400 [WARN]  appendEntries rejected, sending older logs: peer="{Voter node2 127.0.0.1:2224}" next=1
set root tracker key internal:api_key_memory_usage: value 0
Launching server 127.0.0.1:8445
Launching server 127.0.0.1:8448
2025-06-21T11:09:09.874-0400 [INFO]  pipelining replication: peer="{Voter node2 127.0.0.1:2224}"
set root tracker key internal:api_key_disk_usage: value 0
set root tracker key internal:api_key_events: value 0
set root tracker key internal:api_key_subscriptions: value 0
set root tracker key internal:api_key_max_memory_usage:
set root tracker key internal:api_key_max_disk_usage:
set root tracker key internal:api_key_max_events:
set root tracker key internal:api_key_max_subscriptions:

[0;34m==== Pre-Test: Server Ping Check ====[0m
‚úÖ [0;32mServer is online. Proceeding with atomic op tests.[0m

[0;34m==== Test: setnx ====[0m
‚úÖ [0;32mSUCCESS: setnx on new key 'test_setnx_1750518554'[0m
‚úÖ [0;32mValue for 'test_setnx_1750518554' correctly set to 'value1'[0m
‚úÖ [0;32mSUCCESS (Received Expected Conflict): setnx on existing key 'test_setnx_1750518554'[0m
‚úÖ [0;32mValue for 'test_setnx_1750518554' remained 'value1' after failed setnx[0m

[0;34m==== Test: cas (Compare-And-Swap) ====[0m
‚úÖ [0;32mSUCCESS (Received Expected Conflict): cas on non-existent key[0m
‚úÖ [0;32mSUCCESS (Received Expected Conflict): cas with incorrect old value for key 'test_cas_1750518554'[0m
‚úÖ [0;32mValue for 'test_cas_1750518554' remained 'initial_cas_value' after failed cas[0m
‚úÖ [0;32mSUCCESS: cas with correct old value for key 'test_cas_1750518554'[0m
‚úÖ [0;32mValue for 'test_cas_1750518554' correctly updated to 'new_cas_value'[0m

[0;34m==== Test Summary ====[0m
‚úÖ Successful tests: 5
[0;32mAll atomic op tests passed successfully![0m
‚úÖ Success: cas-setnx.sh completed.
üöÄ Running events.sh...
insid pid: 573143
2025-06-21T11:09:16.142-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:09:16.142-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2222 [Follower]" leader-address= leader-id=
2025-06-21T11:09:16.145-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:09:16.145-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2223 [Follower]" leader-address= leader-id=
Launching server 127.0.0.1:8443
Launching server 127.0.0.1:8446
2025-06-21T11:09:16.364-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:09:16.364-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2224 [Follower]" leader-address= leader-id=
2025-06-21T11:09:17.304-0400 [WARN]  no known peers, aborting election
2025-06-21T11:09:17.437-0400 [WARN]  heartbeat timeout reached, starting election: last-leader-addr= last-leader-id=
2025-06-21T11:09:17.437-0400 [INFO]  entering candidate state: node="Node at 127.0.0.1:2222 [Candidate]" term=2
2025-06-21T11:09:17.437-0400 [INFO]  pre-vote successful, starting election: term=2 tally=1 refused=0 votesNeeded=1
2025-06-21T11:09:17.444-0400 [INFO]  election won: term=2 tally=1
2025-06-21T11:09:17.445-0400 [INFO]  entering leader state: leader="Node at 127.0.0.1:2222 [Leader]"
2025-06-21T11:09:17.738-0400 [WARN]  no known peers, aborting election
2025-06-21T11:09:26.157-0400 [INFO]  updating configuration: command=AddVoter server-id=node1 server-addr=127.0.0.1:2223 servers="[{Suffrage:Voter ID:node0 Address:127.0.0.1:2222} {Suffrage:Voter ID:node1 Address:127.0.0.1:2223}]"
2025-06-21T11:09:26.159-0400 [INFO]  added peer, starting replication: peer=node1
set root tracker key internal:api_key_memory_usage: value 0
Launching server 127.0.0.1:8444
Launching server 127.0.0.1:8447
2025-06-21T11:09:26.163-0400 [WARN]  failed to get previous log: previous-index=4 last-index=0 error="log not found"
2025-06-21T11:09:26.164-0400 [WARN]  appendEntries rejected, sending older logs: peer="{Voter node1 127.0.0.1:2223}" next=1
2025-06-21T11:09:26.166-0400 [INFO]  pipelining replication: peer="{Voter node1 127.0.0.1:2223}"
set root tracker key internal:api_key_disk_usage: value 0
set root tracker key internal:api_key_events: value 0
set root tracker key internal:api_key_subscriptions: value 0
set root tracker key internal:api_key_max_memory_usage:
set root tracker key internal:api_key_max_disk_usage:
set root tracker key internal:api_key_max_events:
set root tracker key internal:api_key_max_subscriptions:
2025-06-21T11:09:26.370-0400 [INFO]  updating configuration: command=AddVoter server-id=node2 server-addr=127.0.0.1:2224 servers="[{Suffrage:Voter ID:node0 Address:127.0.0.1:2222} {Suffrage:Voter ID:node1 Address:127.0.0.1:2223} {Suffrage:Voter ID:node2 Address:127.0.0.1:2224}]"
2025-06-21T11:09:26.375-0400 [INFO]  added peer, starting replication: peer=node2
2025-06-21T11:09:26.379-0400 [WARN]  failed to get previous log: previous-index=12 last-index=0 error="log not found"
2025-06-21T11:09:26.379-0400 [WARN]  appendEntries rejected, sending older logs: peer="{Voter node2 127.0.0.1:2224}" next=1
Launching server 127.0.0.1:8445
Launching server 127.0.0.1:8448
2025-06-21T11:09:26.387-0400 [INFO]  pipelining replication: peer="{Voter node2 127.0.0.1:2224}"
--- Test Setup ---
Using insic: /tmp/insi-test-cluster/insic
Using config: /tmp/insi-test-cluster/cluster.yaml
Targeting node: node0
Test directory: /tmp/insic_events_test_sf7MfH
Output file: /tmp/insic_events_test_sf7MfH/output.txt
Topic: test-event-topic-573223
------------------
Starting subscriber for topic 'test-event-topic-573223'...
Subscriber started with PID: 573225. Outputting to: /tmp/insic_events_test_sf7MfH/output.txt
Subscriber process seems to be running.
Publishing 3 messages to topic 'test-event-topic-573223'...
Publishing: 'Hello_World_1_573223'
OK
Publishing: 'Another_Message_2_573223'
OK
Publishing: 'Test_Data_3_573223'
OK
All messages published.
Waiting for messages to be processed (10 seconds)...
Stopping subscriber (PID: 573225)...
Subscriber stopped.
Verifying received messages in /tmp/insic_events_test_sf7MfH/output.txt...
OK: Found message 'Hello_World_1_573223'
OK: Found message 'Another_Message_2_573223'
OK: Found message 'Test_Data_3_573223'
--- Test Summary ---
SUCCESS: All 3 messages were received!
See /tmp/insic_events_test_sf7MfH/output.txt for details.
--------------------
--- Cleaning up ---
Subscriber process (PID: 573225) already exited.
Removing temporary directory: /tmp/insic_events_test_sf7MfH
---------------------
‚úÖ Success: events.sh completed.
üöÄ Running get-set-delete.sh...
insid pid: 573369
2025-06-21T11:09:47.897-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:09:47.897-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2224 [Follower]" leader-address= leader-id=
2025-06-21T11:09:47.898-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:09:47.898-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2222 [Follower]" leader-address= leader-id=
Launching server 127.0.0.1:8443
Launching server 127.0.0.1:8446
2025-06-21T11:09:47.962-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:09:47.962-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2223 [Follower]" leader-address= leader-id=
2025-06-21T11:09:48.977-0400 [WARN]  heartbeat timeout reached, starting election: last-leader-addr= last-leader-id=
2025-06-21T11:09:48.977-0400 [INFO]  entering candidate state: node="Node at 127.0.0.1:2222 [Candidate]" term=2
2025-06-21T11:09:48.977-0400 [INFO]  pre-vote successful, starting election: term=2 tally=1 refused=0 votesNeeded=1
2025-06-21T11:09:48.986-0400 [INFO]  election won: term=2 tally=1
2025-06-21T11:09:48.986-0400 [INFO]  entering leader state: leader="Node at 127.0.0.1:2222 [Leader]"
2025-06-21T11:09:49.545-0400 [WARN]  no known peers, aborting election
2025-06-21T11:09:49.680-0400 [WARN]  no known peers, aborting election
2025-06-21T11:09:57.908-0400 [INFO]  updating configuration: command=AddVoter server-id=node2 server-addr=127.0.0.1:2224 servers="[{Suffrage:Voter ID:node0 Address:127.0.0.1:2222} {Suffrage:Voter ID:node2 Address:127.0.0.1:2224}]"
set root tracker key internal:api_key_memory_usage: value 0
2025-06-21T11:09:57.910-0400 [INFO]  added peer, starting replication: peer=node2
Launching server 127.0.0.1:8445
Launching server 127.0.0.1:8448
2025-06-21T11:09:57.914-0400 [WARN]  failed to get previous log: previous-index=4 last-index=0 error="log not found"
2025-06-21T11:09:57.914-0400 [WARN]  appendEntries rejected, sending older logs: peer="{Voter node2 127.0.0.1:2224}" next=1
2025-06-21T11:09:57.916-0400 [INFO]  pipelining replication: peer="{Voter node2 127.0.0.1:2224}"
set root tracker key internal:api_key_disk_usage: value 0
set root tracker key internal:api_key_events: value 0
set root tracker key internal:api_key_subscriptions: value 0
set root tracker key internal:api_key_max_memory_usage:
set root tracker key internal:api_key_max_disk_usage:
set root tracker key internal:api_key_max_events:
2025-06-21T11:09:57.970-0400 [INFO]  updating configuration: command=AddVoter server-id=node1 server-addr=127.0.0.1:2223 servers="[{Suffrage:Voter ID:node0 Address:127.0.0.1:2222} {Suffrage:Voter ID:node2 Address:127.0.0.1:2224} {Suffrage:Voter ID:node1 Address:127.0.0.1:2223}]"
set root tracker key internal:api_key_max_subscriptions:
2025-06-21T11:09:57.971-0400 [INFO]  added peer, starting replication: peer=node1
2025-06-21T11:09:57.975-0400 [WARN]  failed to get previous log: previous-index=11 last-index=0 error="log not found"
2025-06-21T11:09:57.976-0400 [WARN]  appendEntries rejected, sending older logs: peer="{Voter node1 127.0.0.1:2223}" next=1
Launching server 127.0.0.1:8444
Launching server 127.0.0.1:8447
2025-06-21T11:09:57.984-0400 [INFO]  pipelining replication: peer="{Voter node1 127.0.0.1:2223}"
‚ÑπÔ∏è Using config: /tmp/insi-test-cluster/cluster.yaml

[0;34m==== Pre-Test: Server Ping Check ====[0m
‚úÖ [0;32mServer is online. Proceeding with tests.[0m
‚ÑπÔ∏è Starting TKV cache tests with insic: /tmp/insi-test-cluster/insic

[0;34m==== Test: Cache Set and Get Basic ====[0m
‚úÖ [0;32mSUCCESS: Cache set key 'cachekey_sg_1750518602' to 'cachevalue_sg_1750518602', received 'OK'.[0m
‚ÑπÔ∏è Brief pause after set...
‚úÖ [0;32mSUCCESS: Cache get key 'cachekey_sg_1750518602' returned correct value.[0m

[0;34m==== Test: Cache Delete ====[0m
‚úÖ [0;32mSUCCESS: Cache set key 'cachekey_del_1750518603' for delete test, received 'OK'.[0m
‚úÖ [0;32mSUCCESS: Cache delete key 'cachekey_del_1750518603', received 'OK'.[0m
‚ÑπÔ∏è Brief pause after delete...
‚úÖ [0;32mSUCCESS (Received Expected Error): Cache get deleted key 'cachekey_del_1750518603' (should fail after delete)[0m

[0;34m==== Test: Cache Get Non-Existent Key ====[0m
‚úÖ [0;32mSUCCESS (Received Expected Error): Cache get non-existent key 'nonexistentcachekey_1750518603'[0m

[0;34m==== Test: Cache CLI Argument Validation ====[0m
‚úÖ [0;32mSUCCESS (Received Expected Error): cache set: missing value argument[0m
‚úÖ [0;32mSUCCESS (Received Expected Error): cache set: too many arguments[0m
‚úÖ [0;32mSUCCESS (Received Expected Error): cache get: missing key argument[0m
‚úÖ [0;32mSUCCESS (Received Expected Error): cache get: too many arguments[0m
‚úÖ [0;32mSUCCESS (Received Expected Error): cache delete: missing key argument[0m
‚úÖ [0;32mSUCCESS (Received Expected Error): cache delete: too many arguments[0m

[0;34m==== Test: Cache Iterate by Prefix ====[0m
‚úÖ [0;32mSUCCESS: Cache set key 'c_iter_prefix_1750518603_key1' for iteration[0m
‚úÖ [0;32mSUCCESS: Cache set key 'c_iter_prefix_1750518603_key2' for iteration[0m
‚úÖ [0;32mSUCCESS: Cache set key 'c_iter_prefix_1750518603_key3' for iteration[0m
‚úÖ [0;32mSUCCESS: Cache iterate by prefix 'c_iter_prefix_1750518603_'[0m
‚úÖ [0;32mCache iterate by prefix 'c_iter_prefix_1750518603_' successfully retrieved all expected keys and no extras.[0m

[0;32mAll TKV cache tests completed.[0m

[0;34m==== Test Summary ====[0m
‚úÖ Successful tests: 17
[0;32mAll tests passed successfully![0m
‚úÖ Success: get-set-delete.sh completed.
üöÄ Running cache-cas-setnx.sh...
insid pid: 573695
2025-06-21T11:10:04.879-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:10:04.879-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2224 [Follower]" leader-address= leader-id=
2025-06-21T11:10:04.881-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:10:04.882-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2223 [Follower]" leader-address= leader-id=
2025-06-21T11:10:04.883-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:10:04.883-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2222 [Follower]" leader-address= leader-id=
Launching server 127.0.0.1:8443
Launching server 127.0.0.1:8446
2025-06-21T11:10:06.032-0400 [WARN]  no known peers, aborting election
2025-06-21T11:10:06.383-0400 [WARN]  heartbeat timeout reached, starting election: last-leader-addr= last-leader-id=
2025-06-21T11:10:06.383-0400 [INFO]  entering candidate state: node="Node at 127.0.0.1:2222 [Candidate]" term=2
2025-06-21T11:10:06.383-0400 [INFO]  pre-vote successful, starting election: term=2 tally=1 refused=0 votesNeeded=1
2025-06-21T11:10:06.393-0400 [INFO]  election won: term=2 tally=1
2025-06-21T11:10:06.393-0400 [INFO]  entering leader state: leader="Node at 127.0.0.1:2222 [Leader]"
2025-06-21T11:10:06.633-0400 [WARN]  no known peers, aborting election
2025-06-21T11:10:14.888-0400 [INFO]  updating configuration: command=AddVoter server-id=node2 server-addr=127.0.0.1:2224 servers="[{Suffrage:Voter ID:node0 Address:127.0.0.1:2222} {Suffrage:Voter ID:node2 Address:127.0.0.1:2224}]"
2025-06-21T11:10:14.892-0400 [INFO]  added peer, starting replication: peer=node2
Launching server 127.0.0.1:8445
Launching server 127.0.0.1:8448
2025-06-21T11:10:14.895-0400 [INFO]  updating configuration: command=AddVoter server-id=node1 server-addr=127.0.0.1:2223 servers="[{Suffrage:Voter ID:node0 Address:127.0.0.1:2222} {Suffrage:Voter ID:node2 Address:127.0.0.1:2224} {Suffrage:Voter ID:node1 Address:127.0.0.1:2223}]"
2025-06-21T11:10:14.896-0400 [WARN]  failed to get previous log: previous-index=3 last-index=0 error="log not found"
2025-06-21T11:10:14.896-0400 [WARN]  appendEntries rejected, sending older logs: peer="{Voter node2 127.0.0.1:2224}" next=1
2025-06-21T11:10:14.899-0400 [INFO]  added peer, starting replication: peer=node1
2025-06-21T11:10:14.900-0400 [INFO]  pipelining replication: peer="{Voter node2 127.0.0.1:2224}"
2025-06-21T11:10:14.902-0400 [WARN]  failed to get previous log: previous-index=5 last-index=0 error="log not found"
2025-06-21T11:10:14.902-0400 [WARN]  appendEntries rejected, sending older logs: peer="{Voter node1 127.0.0.1:2223}" next=1
set root tracker key internal:api_key_memory_usage: value 0
2025-06-21T11:10:14.905-0400 [INFO]  pipelining replication: peer="{Voter node1 127.0.0.1:2223}"
Launching server 127.0.0.1:8444
Launching server 127.0.0.1:8447
set root tracker key internal:api_key_disk_usage: value 0
set root tracker key internal:api_key_events: value 0
set root tracker key internal:api_key_subscriptions: value 0
set root tracker key internal:api_key_max_memory_usage:
set root tracker key internal:api_key_max_disk_usage:
set root tracker key internal:api_key_max_events:
set root tracker key internal:api_key_max_subscriptions:

[0;34m==== Pre-Test: Server Ping Check ====[0m
‚úÖ [0;32mServer is online. Proceeding with atomic cache op tests.[0m

[0;34m==== Test: cache setnx ====[0m
‚úÖ [0;32mSUCCESS: cache setnx on new key 'test_cache_setnx_1750518619'[0m
‚úÖ [0;32mValue for 'test_cache_setnx_1750518619' correctly set to 'value1'[0m
‚úÖ [0;32mSUCCESS (Received Expected Conflict/Precondition): cache setnx on existing key 'test_cache_setnx_1750518619'[0m
‚úÖ [0;32mValue for 'test_cache_setnx_1750518619' remained 'value1' after failed setnx[0m

[0;34m==== Test: cache cas (Compare-And-Swap) ====[0m
‚úÖ [0;32mSUCCESS (Received Expected Conflict/Precondition): cas on non-existent key[0m
‚úÖ [0;32mSUCCESS (Received Expected Conflict/Precondition): cas with incorrect old value for key 'test_cache_cas_1750518619'[0m
‚úÖ [0;32mValue for 'test_cache_cas_1750518619' remained 'initial_cas_value' after failed cas[0m
‚úÖ [0;32mSUCCESS: cas with correct old value for key 'test_cache_cas_1750518619'[0m
‚úÖ [0;32mValue for 'test_cache_cas_1750518619' correctly updated to 'new_cas_value'[0m

[0;34m==== Test Summary ====[0m
‚úÖ Successful tests: 5
[0;32mAll atomic cache op tests passed successfully![0m
‚úÖ Success: cache-cas-setnx.sh completed.
üöÄ Running blob.sh...
insid pid: 573893
2025-06-21T11:10:21.325-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:10:21.325-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2223 [Follower]" leader-address= leader-id=
2025-06-21T11:10:21.326-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:10:21.326-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2222 [Follower]" leader-address= leader-id=
2025-06-21T11:10:21.329-0400 [INFO]  initial configuration: index=0 servers=[]
2025-06-21T11:10:21.329-0400 [INFO]  entering follower state: follower="Node at 127.0.0.1:2224 [Follower]" leader-address= leader-id=
Launching server 127.0.0.1:8443
Launching server 127.0.0.1:8446
2025-06-21T11:10:22.612-0400 [WARN]  no known peers, aborting election
2025-06-21T11:10:22.751-0400 [WARN]  no known peers, aborting election
2025-06-21T11:10:23.052-0400 [WARN]  heartbeat timeout reached, starting election: last-leader-addr= last-leader-id=
2025-06-21T11:10:23.052-0400 [INFO]  entering candidate state: node="Node at 127.0.0.1:2222 [Candidate]" term=2
2025-06-21T11:10:23.052-0400 [INFO]  pre-vote successful, starting election: term=2 tally=1 refused=0 votesNeeded=1
2025-06-21T11:10:23.060-0400 [INFO]  election won: term=2 tally=1
2025-06-21T11:10:23.060-0400 [INFO]  entering leader state: leader="Node at 127.0.0.1:2222 [Leader]"
2025-06-21T11:10:31.334-0400 [INFO]  updating configuration: command=AddVoter server-id=node1 server-addr=127.0.0.1:2223 servers="[{Suffrage:Voter ID:node0 Address:127.0.0.1:2222} {Suffrage:Voter ID:node1 Address:127.0.0.1:2223}]"
2025-06-21T11:10:31.338-0400 [INFO]  added peer, starting replication: peer=node1
Launching server 127.0.0.1:8444
Launching server 127.0.0.1:8447
2025-06-21T11:10:31.341-0400 [INFO]  updating configuration: command=AddVoter server-id=node2 server-addr=127.0.0.1:2224 servers="[{Suffrage:Voter ID:node0 Address:127.0.0.1:2222} {Suffrage:Voter ID:node1 Address:127.0.0.1:2223} {Suffrage:Voter ID:node2 Address:127.0.0.1:2224}]"
2025-06-21T11:10:31.342-0400 [WARN]  failed to get previous log: previous-index=3 last-index=0 error="log not found"
2025-06-21T11:10:31.342-0400 [WARN]  appendEntries rejected, sending older logs: peer="{Voter node1 127.0.0.1:2223}" next=1
2025-06-21T11:10:31.344-0400 [INFO]  added peer, starting replication: peer=node2
2025-06-21T11:10:31.346-0400 [INFO]  pipelining replication: peer="{Voter node1 127.0.0.1:2223}"
2025-06-21T11:10:31.348-0400 [WARN]  failed to get previous log: previous-index=5 last-index=0 error="log not found"
2025-06-21T11:10:31.348-0400 [WARN]  appendEntries rejected, sending older logs: peer="{Voter node2 127.0.0.1:2224}" next=1
set root tracker key internal:api_key_memory_usage: value 0
Launching server 127.0.0.1:8445
Launching server 127.0.0.1:8448
2025-06-21T11:10:31.350-0400 [INFO]  pipelining replication: peer="{Voter node2 127.0.0.1:2224}"
set root tracker key internal:api_key_disk_usage: value 0
set root tracker key internal:api_key_events: value 0
set root tracker key internal:api_key_subscriptions: value 0
set root tracker key internal:api_key_max_memory_usage:
set root tracker key internal:api_key_max_disk_usage:
set root tracker key internal:api_key_max_events:
set root tracker key internal:api_key_max_subscriptions:
‚ÑπÔ∏è Test directory prepared at /tmp/insic-blob-tests

[0;34m==== Pre-Test: Server Ping Check ====[0m
‚úÖ [0;32mServer is online. Proceeding with blob tests.[0m

[0;34m==== Test: Blob Lifecycle ====[0m
‚ÑπÔ∏è Created test file '/tmp/insic-blob-tests/upload.txt' with SHA256 hash: e5f1dae104445fafb2376cff15b67671c83c67781e51df6d11b7a0baf20d3d90
‚úÖ [0;32mSUCCESS: Upload blob with key 'test_blob_1750518636_file1.txt'[0m
‚úÖ [0;32mIterate found blob key 'test_blob_1750518636_file1.txt'[0m
‚úÖ [0;32mSUCCESS: Download blob with key 'test_blob_1750518636_file1.txt'[0m
‚ÑπÔ∏è Downloaded file hash: e5f1dae104445fafb2376cff15b67671c83c67781e51df6d11b7a0baf20d3d90
‚úÖ [0;32mDownloaded file content matches original[0m

‚ÑπÔ∏è[1;33m Verifying physical blob existence on ALL nodes...[0m
‚ÑπÔ∏è[1;33m > Key: 'test_blob_1750518636_file1.txt', Hash: 'd59abe3d586edf6c51cb2863f0d336277b29b5241447757a2dbea449c6b18d75', Scope: 'test-cluster-prefix'[0m
‚ÑπÔ∏è[1;33m > Waiting up to 10s for replication to all nodes...[0m
‚úÖ [0;32mVerified blob file exists on all 3 nodes.[0m
‚úÖ [0;32mSUCCESS: Delete blob with key 'test_blob_1750518636_file1.txt'[0m
‚úÖ [0;32mSUCCESS (Received Expected Failure): Attempt to download deleted blob 'test_blob_1750518636_file1.txt'[0m

‚ÑπÔ∏è[1;33m Verifying API no longer lists the deleted blob...[0m
‚úÖ [0;32mIterate no longer finds deleted blob key 'test_blob_1750518636_file1.txt'[0m

‚ÑπÔ∏è[1;33m Verifying physical blob deletion on ALL nodes...[0m
‚ö†Ô∏è The application's blob garbage collector runs every 30 seconds.
‚ÑπÔ∏è[1;33m > WAITING 35 SECONDS for the garbage collector and replication...[0m
‚úÖ [0;32mVerified blob file was physically deleted from all 3 nodes.[0m

[0;34m==== Test: Blob Iteration ====[0m
‚ÑπÔ∏è Uploading test blobs...
‚úÖ [0;32mSUCCESS: Upload blob 1 ('iteration_test_1750518671/file1.txt')[0m
‚úÖ [0;32mSUCCESS: Upload blob 2 ('iteration_test_1750518671/file2.txt')[0m
‚úÖ [0;32mSUCCESS: Upload blob 3 ('iteration_test_1750518671/subdir/file3.txt')[0m
‚úÖ [0;32mSUCCESS: Upload blob 4 ('other_prefix/file4.txt')[0m

‚ÑπÔ∏è Iterating with prefix 'iteration_test_1750518671'...
‚úÖ [0;32mSUCCESS: Iterate found all 3 expected blobs.[0m
‚úÖ [0;32mSUCCESS: Iterate did not find unexpected blob 'other_prefix/file4.txt'.[0m

‚ÑπÔ∏è Testing iteration with limit...
‚úÖ [0;32mSUCCESS: Iterate with limit=2 returned 2 keys.[0m

‚ÑπÔ∏è Testing iteration with offset...
‚úÖ [0;32mSUCCESS: Iterate with offset=2, limit=2 returned 1 key.[0m

‚ÑπÔ∏è Testing iteration with a non-existent prefix...
‚úÖ [0;32mSUCCESS: Iterate with non-existent prefix correctly reported no keys.[0m

‚ÑπÔ∏è Cleaning up uploaded blobs...
‚ÑπÔ∏è Cleanup complete.

[0;34m==== Test Summary ====[0m
‚úÖ Successful tests: 18
[0;32mAll blob tests passed successfully![0m
‚ÑπÔ∏è Test directory cleaned up.
‚úÖ Success: blob.sh completed.
üéâ All tests passed successfully!
